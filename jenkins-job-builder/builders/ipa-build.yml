# ipa-build
#
# The file contains builders used to build the
# freeipa packages from the git source repository

- builder:
    # The builder installs build requirements
    # of freeipa project
    #
    # The builder does not set up its own required repositories.
    name: install-freeipa-builddeps
    builders:
        - shell: |
            # FreeIPA requires:
            sudo dnf builddep -y --spec freeipa.spec.in
        - shell: "rpm -qa | sort"

- builder:
    # The builder builds RPMs in the git tree with customized
    # version value
    name: build-rpms
    builders:
        - shell: |
            git clean -fxd
            echo $(date -u +%Y%m%d%H%M%SZ)jenkins${BUILD_NUMBER}git$(git rev-parse --short HEAD) > RELEASE
            make rpms

